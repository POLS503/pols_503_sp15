---
title: "Challenger Analysis"
author: "Jeffrey B. Arnold"
date: "03/31/2015"
output: html_document
---

```{r}
library("alr4")
library("dplyr")
library("ggplot2")
```

```{r}
data("Challeng")

gg <- (ggplot(Challeng, aes(x=temp, y=damage))
       + geom_point(position = position_jitter(height=0, width=1))
       + scale_y_continuous("O-ring Damage Index")
       + scale_x_continuous("Temperature (F)", limits = c(25, 85), breaks = seq(30, 80, 10))
        )
gg
```


```{r}
glm(damage ~ temp, data = Challeng)
```

```{r}
gg + geom_smooth(method = "lm")
```

```{r}
Challeng <- 
  Challeng %>% mutate(any_damage = as.integer(damage > 0))

ggplot(Challeng, aes(x = temp, y = any_damage)) +
  geom_point() + geom_smooth(family = "binomial", method = "glm")
```

```{r}
model <- glm(any_damage ~ temp, family = "binomial", data = Challeng)
predict(model, newdata = data.frame(data.frame(temp = 30)), type = "response")
```


**DON'T LAUNCH!** 

